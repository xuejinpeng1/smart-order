{"remainingRequest":"C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\src\\components\\menu\\menu.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\src\\components\\menu\\menu.vue","mtime":1569573444081},{"path":"C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\web\\Desktop\\12233\\team-work\\team work\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      foodType: [],\n      //FT_ID食物类型ID,FT_Name食物类型名字\n      foodData: [],\n      //F_ID食物编号,F_FTID店家编号,F_Name食物名字,F_Url食物图片地址,F_Price价格,num点了多少个\n      count: 0,\n      //嗯，当成一共点了多少个食物好了，完美\n      shopcart_imgbgcolor: \"#555\",\n      //控制购物车背景变色\n      shopcart_countdisplay: \"none\",\n      //控制右上红色数字到0的时候不显示\n      cartDisplay: 0,\n      //判断购物车是否展开\n      totalPrice: 0,\n      //食物的总价\n      sendPrice: 400,\n      //先来个起送价400\n      now: 0 //辅助修改颜色\n      //{ M_ID(店家ID),D_ID(桌子ID),foodData:[{F_ID(F_ID食物编号),F_Price(F_Price价格),num(num点了多少个)},{},{},...] }\n\n    };\n  },\n  methods: {\n    loadMenu: function loadMenu() {\n      var _this = this;\n\n      // var M_ID=this.$route.query.M_ID; 拿到店面ID\n      var M_ID = 1; // var D_ID=this.$route.query.D_ID; 拿到桌子ID\n      // var D_ID=1;\n\n      var url = \"/menu\"; //获取左边所有菜品类名\n\n      this.axios.get(url, {\n        params: {\n          M_ID: M_ID\n        }\n      }).then(function (res) {\n        if (res.data.code == 1) {\n          _this.foodType = res.data.data;\n\n          for (var i = 0; i < _this.foodType.length; i++) {\n            _this.foodType[i].bgcolor = \"\"; //增加一个属性用于修改滚动条到了之后的颜色\n          }\n        }\n      });\n      var url2 = \"/menu/food\"; //获取所有食物\n\n      this.axios.get(url2, {\n        params: {\n          M_ID: M_ID\n        }\n      }).then(function (res) {\n        if (res.data.code == 1) {\n          _this.foodData = res.data.data; // console.log(this.foodData);\n\n          for (var i = 0; i < _this.foodData.length; i++) {\n            _this.foodData[i].num = 0; //增加一个属性用于计数\n          }\n        }\n      });\n    },\n    // 数量--\n    cuts: function cuts(n) {\n      if (this.foodData[n - 1].num < 1) return;\n      this.count--;\n      console.log(this.count);\n      this.foodData[n - 1].num--; //对应食物数量减少 数组下标是(n-1)\n\n      if (this.count == 0) {\n        //减到0之后，失去高光(灰色)和count\n        this.shopcart_imgbgcolor = \"#555\";\n        this.shopcart_countdisplay = \"none\";\n      }\n\n      this.totalPrice -= this.foodData[n - 1].F_Price; //总价减少\n    },\n    //数量++\n    add: function add(n) {\n      this.count++;\n      console.log(this.count);\n      this.foodData[n - 1].num++; //对应食物数量增加 数组下标是(n-1)\n\n      this.shopcart_imgbgcolor = \"#1798dc\"; //增加后绝对大于0，不加判断了\n\n      this.shopcart_countdisplay = \"\"; //同上一行\n\n      this.totalPrice += this.foodData[n - 1].F_Price; //总价增加\n    },\n    //清空购物车\n    clearCart: function clearCart() {\n      var _this2 = this;\n\n      this.$messagebox.confirm(\"确认清空吗？\").then(function (action) {\n        for (var i = 0; i < _this2.foodData.length; i++) {\n          _this2.foodData[i].num = 0;\n          _this2.totalPrice = 0; //总价清零\n\n          _this2.shopcart_imgbgcolor = \"#555\"; //控制购物车背景变色\n\n          _this2.shopcart_countdisplay = \"none\"; //控制右上红色数字到0的时候不显示\n\n          _this2.cartDisplay = 0; //重置是否展开状态\n        }\n\n        _this2.count = 0;\n      });\n    },\n    //展开或关闭购物车\n    showCart: function showCart() {\n      if (this.cartDisplay == 0) {\n        this.cartDisplay = 1;\n      } else {\n        this.cartDisplay = 0;\n      }\n    },\n    jump: function jump(index) {\n      // 用 class=\"d_jump\" 添加锚点\n      var jump = document.querySelectorAll(\".fenlei\");\n      var total = jump[index].offsetTop;\n      var distance = document.documentElement.scrollTop || document.body.scrollTop; // 平滑滚动，时长500ms，每10ms一跳，共10跳\n\n      var step = total / 10; //10跳\n\n      if (total > distance) {\n        smoothDown();\n      } else {\n        var newTotal = distance - total;\n        step = newTotal / 10; //上升速度\n\n        smoothUp();\n      }\n\n      function smoothDown() {\n        if (distance < total) {\n          distance += step;\n          document.body.scrollTop = distance;\n          document.documentElement.scrollTop = distance;\n          setTimeout(smoothDown, 10);\n        } else {\n          document.body.scrollTop = total;\n          document.documentElement.scrollTop = total;\n        }\n      }\n\n      function smoothUp() {\n        if (distance > total) {\n          distance -= step;\n          document.body.scrollTop = distance;\n          document.documentElement.scrollTop = distance;\n          setTimeout(smoothUp, 10);\n        } else {\n          document.body.scrollTop = total;\n          document.documentElement.scrollTop = total;\n        }\n      }\n    },\n    //监听滚动条\n    onScroll: function onScroll() {\n      //滚动条现在的高度\n      var scrolled = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n      var jump = document.querySelectorAll(\".fenlei\"); //jump[index].offsetTop;这个是高度\n      //用于重置颜色\n\n      for (var i = 0; i < this.foodType.length; i++) {\n        this.foodType[i].bgcolor = \"\";\n      }\n\n      for (var index = 0; index < jump.length - 1; index++) {\n        if (jump[index].offsetTop < scrolled && scrolled < jump[index + 1].offsetTop) {\n          this.foodType[index].bgcolor = \"#fff\"; //变成该颜色(白)\n\n          this.now++; //辅助修改颜色(无意义)\n        }\n      } // if (scrolled >= 1063) {\n      //   this.steps.active = 2;\n      // } else if (scrolled < 1063 && scrolled >= 586) {\n      //   this.steps.active = 1;\n      // } else {\n      //   this.steps.active = 0;\n      // }\n\n    },\n    //选好后去订单页面\n    toOrder: function toOrder() {\n      //{ M_ID(店家ID),D_ID(桌子ID),foodData:[{F_ID(F_ID食物编号),F_Price(F_Price价格),num(num点了多少个)},{},{},...] }需要传输的数据\n      var potCount = 0;\n\n      for (var i = 0; i < this.foodData.length; i++) {\n        //遍历计数锅的个数\n        if (this.foodData[i].F_FTID == 1 || this.foodData[i].F_FTID == 2 || this.foodData[i].F_FTID == 3) {\n          potCount += this.foodData[i].num;\n        }\n      } //根据锅的数量判断\n\n\n      if (potCount > 1) {\n        this.$toast({\n          message: \"一单只限一个锅。\"\n        });\n      }\n\n      if (potCount < 1) {\n        this.$toast({\n          message: \"请至少点一个锅。\"\n        });\n      }\n\n      if (potCount == 1) {\n        var foodData = [];\n\n        for (var i = 0; i < this.foodData.length; i++) {\n          if (this.foodData[i].num == 0) {\n            continue;\n          }\n\n          var example = {\n            F_ID: this.foodData[i].F_ID,\n            F_Price: this.foodData[i].F_Price,\n            num: this.foodData[i].num\n          };\n          foodData.push(example);\n        }\n\n        this.$router.push({\n          path: '/waisong',\n          query: {\n            M_ID: 1,\n            D_ID: 1,\n            foodData: foodData,\n            count: this.count,\n            totalPrice: this.totalPrice\n          }\n        }); //this.$route.query.M_ID,this.$route.query.D_ID\n\n        console.log(foodData);\n      }\n    }\n  },\n  created: function created() {\n    this.loadMenu();\n  },\n  mounted: function mounted() {\n    this.$nextTick(function () {\n      window.addEventListener(\"scroll\", this.onScroll);\n    });\n  }\n};",{"version":3,"sources":["menu.vue"],"names":[],"mappings":"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","sourcesContent":["<!--menu.vue 菜单组件-->\r\n<template>\r\n  <div class=\"menu\">\r\n    <div class=\"left\">\r\n      <ul>\r\n        <li v-for=\"(item, i) in foodType\" :key=\"i\" @click=\"jump(i)\" :style=\"`background-color:${item.bgcolor}`\">{{item.FT_Name}}\r\n          <span style=\"display:none\">{{now}}</span>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"jiade\"></div>\r\n    <!-- 左侧空div撑开 -->\r\n    <div class=\"right\">\r\n      <!-- 右侧菜品 -->\r\n      <div v-for=\"(item,index) in foodType\" :key=\"index\">\r\n        <div class=\"fenlei\" :id=\"`FT${item.FT_ID}`\">{{item.FT_Name}}</div>\r\n        <div v-for=\"(food,index) in foodData\" :key=\"index\" class=\"guilei\">\r\n          <img v-if=\"food.F_FTID==item.FT_ID\" :src=\"`http://127.0.0.1:5050/menu${food.F_Url}`\" alt>\r\n          <div v-if=\"food.F_FTID==item.FT_ID\" class=\"food\">\r\n            <p class=\"mTitle\">{{food.F_Name}}</p>\r\n            <p class=\"mPrice\">\r\n              <i>￥</i>\r\n              {{food.F_Price}}\r\n            </p>\r\n          </div>\r\n          <div v-if=\"food.F_FTID==item.FT_ID\" class=\"count\">\r\n            <a class=\"cut\" @click=\"cuts(food.F_ID)\"></a>\r\n            <span>{{food.num}}</span>\r\n            <a class=\"add\" @click=\"add(food.F_ID)\"></a>\r\n            <span style=\"display:none;\">{{count}}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"faker\"></div>\r\n      <!-- 用于顶起被底部购物车遮住的部分 -->\r\n    </div>\r\n\r\n    <div class=\"shopcartcontent\" v-if=\"count!=0 && cartDisplay!=0\">\r\n      <!-- 购物车里面食物的内容 -->\r\n      <div>\r\n        <span>购物车</span>\r\n        <a @click=\"clearCart\">清空购物车</a>\r\n      </div>\r\n      <div></div>\r\n      <ul>\r\n        <li v-for=\"(food,index) in foodData\" :key=\"index\">\r\n          <div v-if=\"food.num!=0\">\r\n            <span>{{food.F_Name}}</span>\r\n            <span>￥{{food.F_Price*food.num}}</span>\r\n            <a class=\"cut\" @click=\"cuts(food.F_ID)\"></a>\r\n            <span>{{food.num}}</span>\r\n            <a class=\"add\" @click=\"add(food.F_ID)\"></a>\r\n            <span style=\"display:none;\">{{count}}</span>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div class=\"shopcart\">\r\n      <!-- 底部购物车 -->\r\n      <div\r\n        class=\"shopcart_img\"\r\n        :style=\"`background-color:${shopcart_imgbgcolor}`\"\r\n        @click=\"showCart\"\r\n      >\r\n        <img src=\"http://127.0.0.1:5050/icon/shopcart_icon.png\">\r\n        <div :style=\"`display:${shopcart_countdisplay}`\">{{count}}</div>\r\n        <!-- 右上食物计数 -->\r\n        <span class=\"totalprice\">￥{{totalPrice}}</span>\r\n      </div>\r\n      <button v-if=\"totalPrice>=sendPrice\" @click=\"toOrder\">选好啦</button>\r\n      <span v-if=\"totalPrice<sendPrice\">￥{{sendPrice}}起</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      foodType: [], //FT_ID食物类型ID,FT_Name食物类型名字\r\n      foodData: [], //F_ID食物编号,F_FTID店家编号,F_Name食物名字,F_Url食物图片地址,F_Price价格,num点了多少个\r\n      count: 0, //嗯，当成一共点了多少个食物好了，完美\r\n      shopcart_imgbgcolor: \"#555\", //控制购物车背景变色\r\n      shopcart_countdisplay: \"none\", //控制右上红色数字到0的时候不显示\r\n      cartDisplay: 0, //判断购物车是否展开\r\n      totalPrice: 0, //食物的总价\r\n      sendPrice: 400, //先来个起送价400\r\n      now:0,//辅助修改颜色\r\n\r\n      //{ M_ID(店家ID),D_ID(桌子ID),foodData:[{F_ID(F_ID食物编号),F_Price(F_Price价格),num(num点了多少个)},{},{},...] }\r\n\r\n    };\r\n  },\r\n  methods: {\r\n    loadMenu() {\r\n      // var M_ID=this.$route.query.M_ID; 拿到店面ID\r\n      var M_ID = 1;\r\n      // var D_ID=this.$route.query.D_ID; 拿到桌子ID\r\n      // var D_ID=1;\r\n\r\n      var url = \"/menu\"; //获取左边所有菜品类名\r\n      this.axios.get(url, { params: { M_ID: M_ID } }).then(res => {\r\n        if (res.data.code == 1) {\r\n          this.foodType = res.data.data;\r\n          for (var i = 0; i < this.foodType.length; i++) {\r\n            this.foodType[i].bgcolor = \"\";//增加一个属性用于修改滚动条到了之后的颜色\r\n          }\r\n        }\r\n      });\r\n\r\n      var url2 = \"/menu/food\"; //获取所有食物\r\n      this.axios.get(url2, { params: { M_ID: M_ID } }).then(res => {\r\n        if (res.data.code == 1) {\r\n          this.foodData = res.data.data;\r\n          // console.log(this.foodData);\r\n          for (var i = 0; i < this.foodData.length; i++) {\r\n            this.foodData[i].num = 0;//增加一个属性用于计数\r\n          }\r\n        }\r\n      });\r\n    },\r\n    // 数量--\r\n    cuts: function(n) {\r\n      if (this.foodData[n - 1].num < 1) return;\r\n      this.count--;\r\n      console.log(this.count);\r\n      this.foodData[n - 1].num--; //对应食物数量减少 数组下标是(n-1)\r\n      if (this.count == 0) {\r\n        //减到0之后，失去高光(灰色)和count\r\n        this.shopcart_imgbgcolor = \"#555\";\r\n        this.shopcart_countdisplay = \"none\";\r\n      }\r\n      this.totalPrice -= this.foodData[n - 1].F_Price; //总价减少\r\n    },\r\n    //数量++\r\n    add: function(n) {\r\n      this.count++;\r\n      console.log(this.count);\r\n      this.foodData[n - 1].num++; //对应食物数量增加 数组下标是(n-1)\r\n      this.shopcart_imgbgcolor = \"#1798dc\"; //增加后绝对大于0，不加判断了\r\n      this.shopcart_countdisplay = \"\"; //同上一行\r\n      this.totalPrice += this.foodData[n - 1].F_Price; //总价增加\r\n    },\r\n\r\n    //清空购物车\r\n    clearCart() {\r\n      this.$messagebox.confirm(\"确认清空吗？\").then(action => {\r\n        for (var i = 0; i < this.foodData.length; i++) {\r\n          this.foodData[i].num = 0;\r\n          this.totalPrice = 0; //总价清零\r\n          this.shopcart_imgbgcolor = \"#555\"; //控制购物车背景变色\r\n          this.shopcart_countdisplay = \"none\"; //控制右上红色数字到0的时候不显示\r\n          this.cartDisplay = 0;//重置是否展开状态\r\n        }\r\n        this.count = 0;\r\n      });\r\n    },\r\n    //展开或关闭购物车\r\n    showCart() {\r\n      if (this.cartDisplay == 0) {\r\n        this.cartDisplay = 1;\r\n      } else {\r\n        this.cartDisplay = 0;\r\n      }\r\n    },\r\n\r\n    jump(index) {\r\n      // 用 class=\"d_jump\" 添加锚点\r\n      let jump = document.querySelectorAll(\".fenlei\");\r\n      let total = jump[index].offsetTop;\r\n      let distance = document.documentElement.scrollTop || document.body.scrollTop;\r\n      // 平滑滚动，时长500ms，每10ms一跳，共10跳\r\n      let step = total / 10;//10跳\r\n      if (total > distance) {\r\n        smoothDown();\r\n      } else {\r\n        let newTotal = distance - total;\r\n        step = newTotal / 10;//上升速度\r\n        smoothUp();\r\n      }\r\n      function smoothDown() {\r\n        if (distance < total) {\r\n          distance += step;\r\n          document.body.scrollTop = distance;\r\n          document.documentElement.scrollTop = distance;\r\n          setTimeout(smoothDown, 10);\r\n        } else {\r\n          document.body.scrollTop = total;\r\n          document.documentElement.scrollTop = total;\r\n        }\r\n      }\r\n      function smoothUp() {\r\n        if (distance > total) {\r\n          distance -= step;\r\n          document.body.scrollTop = distance;\r\n          document.documentElement.scrollTop = distance;\r\n          setTimeout(smoothUp, 10);\r\n        } else {\r\n          document.body.scrollTop = total;\r\n          document.documentElement.scrollTop = total;\r\n        }\r\n      }\r\n    },\r\n\r\n    //监听滚动条\r\n    onScroll() {\r\n      //滚动条现在的高度\r\n      let scrolled =\r\n        document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\r\n        let jump = document.querySelectorAll(\".fenlei\");\r\n        //jump[index].offsetTop;这个是高度\r\n        //用于重置颜色\r\n        for(var i=0;i<this.foodType.length;i++){\r\n          this.foodType[i].bgcolor=\"\";\r\n        }\r\n        for(var index=0;index<jump.length-1;index++){\r\n          if(jump[index].offsetTop<scrolled&&scrolled<jump[index+1].offsetTop){\r\n            this.foodType[index].bgcolor=\"#fff\";//变成该颜色(白)\r\n            this.now++;//辅助修改颜色(无意义)\r\n          }\r\n        }\r\n      // if (scrolled >= 1063) {\r\n      //   this.steps.active = 2;\r\n      // } else if (scrolled < 1063 && scrolled >= 586) {\r\n      //   this.steps.active = 1;\r\n      // } else {\r\n      //   this.steps.active = 0;\r\n      // }\r\n    },\r\n    //选好后去订单页面\r\n    toOrder(){\r\n      //{ M_ID(店家ID),D_ID(桌子ID),foodData:[{F_ID(F_ID食物编号),F_Price(F_Price价格),num(num点了多少个)},{},{},...] }需要传输的数据\r\n      var potCount=0;\r\n\r\n      for(var i=0;i<this.foodData.length;i++){//遍历计数锅的个数\r\n        if(this.foodData[i].F_FTID==1||this.foodData[i].F_FTID==2||this.foodData[i].F_FTID==3){\r\n          potCount+=this.foodData[i].num;\r\n        }\r\n      }\r\n      //根据锅的数量判断\r\n      if(potCount>1){\r\n        this.$toast({message:\"一单只限一个锅。\"});\r\n      }\r\n      if(potCount<1){\r\n        this.$toast({message:\"请至少点一个锅。\"});\r\n      }\r\n      if(potCount==1){\r\n        var foodData=[];\r\n        for(var i=0;i<this.foodData.length;i++){\r\n          if(this.foodData[i].num==0){continue;}\r\n          var example={F_ID:this.foodData[i].F_ID,F_Price:this.foodData[i].F_Price,num:this.foodData[i].num}\r\n          foodData.push(example);\r\n        }\r\n        this.$router.push({ path: '/waisong' ,query: {M_ID: 1,D_ID:1,foodData,count:this.count,totalPrice:this.totalPrice}});\r\n                                               //this.$route.query.M_ID,this.$route.query.D_ID\r\n        console.log(foodData);\r\n      }\r\n\r\n    }\r\n  },\r\n  created() {\r\n    this.loadMenu();\r\n  },\r\n  mounted() {\r\n    this.$nextTick(function() {\r\n      window.addEventListener(\"scroll\", this.onScroll);\r\n    });\r\n  },\r\n  \r\n\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\ndiv.menu {\r\n  div.jiade {\r\n    float: left;\r\n    width: 20%;\r\n    height: 1rem;\r\n  }\r\n  box-sizing: border-box;\r\n  div.left {\r\n    width: 20%;\r\n    position: fixed;\r\n\r\n    ul li {\r\n      padding-top: 0.5rem;\r\n      height: 0.5rem;\r\n      width: 100%;\r\n      background: #f3f1f4;\r\n      // border-bottom: 1px solid #bbb;\r\n      // border-right: 1px solid #bbb;\r\n      font-size: 0.3rem;\r\n    }\r\n  }\r\n  div.right {\r\n    div.fenlei {\r\n      padding: 0.2rem 0 0.2rem 0.2rem;\r\n      font-size: 0.3rem;\r\n      // background:#868586;\r\n      font-weight: bold;\r\n    }\r\n    div.food {\r\n      display: inline-block;\r\n      p {\r\n        font-size: 0.3rem;\r\n      }\r\n      p.mPrice {\r\n        margin-top: 0.5rem;\r\n        color: #fb3b2a;\r\n        font-weight: 700;\r\n        i {\r\n          font-style: normal;\r\n          font-size: 0.2rem;\r\n          margin-right: -0.1rem;\r\n        }\r\n      }\r\n      p.mTitle {\r\n        margin-top: 0.3rem;\r\n      }\r\n    }\r\n    text-align: left;\r\n    float: left;\r\n    width: 80%;\r\n    div.count {\r\n      display: inline-block;\r\n      text-align: center;\r\n      position: absolute;\r\n      bottom: 0.2rem;\r\n      right: 0.2rem;\r\n      span {\r\n        display: inline-block;\r\n        width: 0.5rem;\r\n        font-size: 0.35rem;\r\n        position: relative;\r\n        top: -0.05rem;\r\n      }\r\n      a.add {\r\n        display: inline-block;\r\n        height: 0.35rem;\r\n        width: 0.35rem;\r\n        border-radius: 50%;\r\n        background-image: url(http://127.1:5050/icon/plus.png);\r\n        background-size: contain;\r\n        background-position: bottom;\r\n        background-repeat: no-repeat;\r\n      }\r\n      a.cut {\r\n        display: inline-block;\r\n        height: 0.35rem;\r\n        width: 0.35rem;\r\n        border-radius: 50%;\r\n        background-image: url(http://127.1:5050/icon/reduce.png);\r\n        background-size: contain;\r\n        background-position: center;\r\n        background-repeat: no-repeat;\r\n      }\r\n    }\r\n    img {\r\n      width: 1.5rem;\r\n      vertical-align: top;\r\n      margin: 0.2rem 0.2rem 0 0.2rem;\r\n    }\r\n  }\r\n}\r\n\r\n.guilei {\r\n  position: relative;\r\n}\r\n.faker {\r\n  height: 1rem;\r\n  width: 100%;\r\n}\r\n\r\n.shopcart {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 1rem;\r\n  position: fixed;\r\n  z-index: 10;\r\n  bottom: 0;\r\n  background-color: #555;\r\n  button {\r\n    position: absolute;\r\n    bottom: 0rem;\r\n    right: 0rem;\r\n    height: 1rem;\r\n    width: 2rem;\r\n    background-color: #1798dc;\r\n    font-size: 0.3rem; // \"选好啦\"字体大小\r\n    color: #fff;\r\n    font-weight: bold;\r\n    z-index: 10;\r\n  }\r\n}\r\n.shopcart > span {\r\n  //XX元起送\r\n  position: absolute;\r\n  bottom: 0rem;\r\n  right: 0.2rem;\r\n  font-size: 0.4rem;\r\n  color: #fff;\r\n  line-height: 1rem;\r\n  z-index: 5;\r\n}\r\n.shopcart > .shopcart_img {\r\n  //购物车图片\r\n  position: relative;\r\n  text-align: center;\r\n  line-height: 0.8rem;\r\n  height: 0.8rem;\r\n  width: 0.8rem;\r\n  border-radius: 50%;\r\n  border: 0.1rem solid black;\r\n  img {\r\n    height: 80%;\r\n  }\r\n  div {\r\n    line-height: 0.35rem;\r\n    font-size: 0.1rem;\r\n    color: #fff;\r\n    width: 0.35rem;\r\n    height: 0.35rem;\r\n    border-radius: 50%;\r\n    border: 0.01rem solid #fff;\r\n    background-color: #fb3b2a;\r\n    position: absolute;\r\n    right: -0.15rem;\r\n    top: -0.15rem;\r\n  }\r\n  .totalprice {\r\n    color: #fff;\r\n    font-size: 0.5rem;\r\n    position: absolute;\r\n    top: 0rem;\r\n    left: 1rem;\r\n  }\r\n}\r\n\r\n.shopcartcontent {\r\n  //存放已点的食物\r\n  height: 3rem;\r\n  width: 100%;\r\n  overflow-y: auto;\r\n  position: fixed;\r\n  bottom: 1rem;\r\n  background-color: #fff;\r\n}\r\n.shopcartcontent > div {\r\n  position: relative;\r\n  height: 0.5rem;\r\n  background-color: #fdc09d;\r\n  line-height: 0.3rem;\r\n  font-size: 0.3rem;\r\n\r\n  span {\r\n    position: absolute;\r\n    left: 0.2rem;\r\n    top: 0.1rem;\r\n  }\r\n  a {\r\n    font-size: 0.28rem;\r\n    position: absolute;\r\n    right: 0.2rem;\r\n    top: 0.1rem;\r\n  }\r\n}\r\n.shopcartcontent > div:nth-child(1) {\r\n  z-index: 10;\r\n  position: fixed;\r\n  height: 0rem;\r\n  height: 0.5rem;\r\n  width: 100%;\r\n  background-color: #fdc09d;\r\n  line-height: 0.3rem;\r\n  font-size: 0.3rem;\r\n}\r\n\r\n.shopcartcontent > ul > li > div {\r\n  height: 0.6rem;\r\n  position: relative;\r\n  font-size: 0.3rem;\r\n  span:nth-child(1) {\r\n    //食物名字\r\n    position: absolute;\r\n    left: 0.2rem;\r\n    top: 0.2rem;\r\n  }\r\n  span:nth-child(2) {\r\n    //食物总价\r\n    position: absolute;\r\n    left: 3.5rem;\r\n    top: 0.2rem;\r\n  }\r\n  a:nth-child(3) {\r\n    //\"-\"\r\n    position: absolute;\r\n    right: 1rem;\r\n    top: 0.2rem;\r\n  }\r\n  span:nth-child(4) {\r\n    //食物数量\r\n    position: absolute;\r\n    right: 0.6rem;\r\n    top: 0.23rem;\r\n  }\r\n  a:nth-child(5) {\r\n    //\"+\"\r\n    position: absolute;\r\n    right: 0.2rem;\r\n    top: 0.2rem;\r\n  }\r\n  a.cut {\r\n    display: inline-block;\r\n    height: 0.35rem;\r\n    width: 0.35rem;\r\n    border-radius: 50%;\r\n    background-image: url(http://127.1:5050/icon/reduce.png);\r\n    background-size: contain;\r\n    background-position: center;\r\n    background-repeat: no-repeat;\r\n  }\r\n  a.add {\r\n    display: inline-block;\r\n    height: 0.35rem;\r\n    width: 0.35rem;\r\n    border-radius: 50%;\r\n    background-image: url(http://127.1:5050/icon/plus.png);\r\n    background-size: contain;\r\n    background-position: center;\r\n    background-repeat: no-repeat;\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/menu"}]}